{% assign s = block.settings %}
{% if s.enable_overlay %}
  {% capture overlay_style %}
      background: {{ s.overlay_color }};
      opacity: {{ s.overlay_opacity | divided_by: 100.0 }};
  {% endcapture %}
{% endif %}

{% capture scheme_class %}
  {% unless s.inherit_styles %}color-{{ s.color_scheme | default: 'none' }}{% endunless %}
{% endcapture %}

{% assign placeholder_name = 'scene-1' %}
{% unless s.show_placeholder %}
  {% assign placeholder_name = '' %}
{% endunless %}

<div
  class="slide-block w-[var(--slide-width)] md:w-[var(--slide-width-md)] flex-shrink-0 snap-start relative overflow-hidden {{ scheme_class }} bg-surface"
  {{ context.attached_attributes }}
>
  <div class="absolute inset-0 z-media bg-surface">
    {% render 'media',
      src: s.image,
      src_mobile: s.image_mobile,
      video: s.video_url,
      fit: 'cover',
      placeholder: placeholder_name,
      animate: s.enable_zoom
    %}

    <div
      class="absolute inset-0 pointer-events-none"
      style="{{ overlay_style }}"
    ></div>
  </div>

  <div class="wrapper absolute inset-0 z-content flex flex-col flex-auto gap-4 section-align-content-{{ s.content_align }} section-align-v-{{ s.vertical_align }} section-align-text-{{ s.text_align }} stagger-load">
    {% content_for 'blocks' %}
  </div>
</div>

{% schema %}
{
  "name": "Slide",
  "settings": [
    { "type": "header", "content": "Media" },
    { "type": "image_picker", "id": "image", "label": "Desktop Image" },
    { "type": "image_picker", "id": "image_mobile", "label": "Mobile Image" },
    { "type": "text", "id": "video_url", "label": "Video URL (MP4)" },
    {
      "type": "checkbox",
      "id": "show_placeholder",
      "label": "Show Placeholder",
      "default": true,
      "info": "Show a pattern when no image is selected."
    },
    { "type": "checkbox", "id": "enable_zoom", "label": "Enable Ken Burns (Zoom)", "default": false },

    {
      "type": "header",
      "content": "Overlay Style"
    },
    {
      "type": "checkbox",
      "id": "enable_overlay",
      "label": "Use Overlay",
      "default": false
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Tint Color",
      "default": "#000000",
      "conditional": "setting.enable_overlay == true"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Opacity",
      "min": 0,
      "max": 100,
      "default": 40,
      "conditional": "setting.enable_overlay == true"
    },

    { "type": "header", "content": "Alignment" },
    {
      "type": "select",
      "id": "content_align",
      "label": "Content Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "text_align",
      "label": "Text Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "vertical_align",
      "label": "Vertical Alignment",
      "options": [
        { "value": "top", "label": "Top" },
        { "value": "middle", "label": "Middle" },
        { "value": "bottom", "label": "Bottom" }
      ],
      "default": "middle"
    },
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "checkbox",
      "id": "inherit_styles",
      "label": "Inherit Color Scheme",
      "default": true
    },
    {
      "type": "header",
      "content": "Overrides",
      "conditional": "setting.inherit_styles != true"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Palette",
      "default": "default",
      "conditional": "setting.inherit_styles != true"
    }
  ],
  "blocks": [{ "type": "@theme" }],
  "presets": [
    {
      "name": "Slide",
      "blocks": {
        "heading": {
          "type": "text",
          "settings": { "content": "New Slide", "display_size": "display", "tag": "h1", "font_weight": "bold" }
        },
        "button": {
          "type": "button",
          "settings": { "label": "View Menu", "style": "primary" }
        }
      },
      "block_order": ["heading", "button"]
    }
  ]
}
{% endschema %}
