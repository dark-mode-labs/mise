{% assign s = block.settings %}
{% assign ss = section.settings %}

{% if ss.enable_cards_global %}
  {% assign card_class = 'bg-surface' %}
  {% if s.override_card_style and s.show_shadow %}
    {% assign card_class = card_class | append: ' shadow-md' %}
  {% elsif ss.card_shadow_global %}
    {% assign card_class = card_class | append: ' shadow-md' %}
  {% endif %}

  {% capture style_override %}
      {% if s.background_color and s.override_card_style %}
        --color-surface: {{ s.background_color }};
      {% endif %}
      {% if s.padding and s.override_card_style %}
        padding: {{ s.padding }}px;
      {% else %}
        padding: {{ ss.card_padding_global }}px;
      {% endif %}
    {% endcapture %}
  {% if style_override %}
    {% assign style_override = 'style="{{ style_override }}"' %}
  {% endif %}
{% endif %}

<div
  class="column-block flex flex-col flex-auto gap-4 section-align-content-{{ s.content_align }} section-align-v-{{ s.vertical_align }} section-align-text-{{ s.text_align }} {{ card_class }} rounded-global"
  {{ style_override }}
>
  {% content_for 'blocks' %}
</div>

{% schema %}
{
  "name": "Column",
  "settings": [
    { "type": "header", "content": "Alignment" },
    {
      "type": "select",
      "id": "content_align",
      "label": "Content Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "text_align",
      "label": "Text Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "vertical_align",
      "label": "Vertical Alignment",
      "options": [
        { "value": "top", "label": "Top" },
        { "value": "middle", "label": "Middle" },
        { "value": "bottom", "label": "Bottom" }
      ],
      "default": "middle"
    },
    {
      "type": "header",
      "content": "Card Style"
    },
    {
      "type": "checkbox",
      "id": "override_card_style",
      "label": "Override Card Style",
      "default": false
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#F5F5F5",
      "conditional": "setting.override_card_style == true"
    },
    {
      "type": "range",
      "id": "padding",
      "label": "Padding",
      "min": 0,
      "max": 60,
      "step": 4,
      "default": 24,
      "conditional": "setting.override_card_style == true"
    },
    {
      "type": "checkbox",
      "id": "show_shadow",
      "label": "Show Shadow",
      "default": false,
      "conditional": "setting.override_card_style == true"
    }
  ],
  "blocks": [{ "type": "@theme" }],
  "presets": [
    {
      "name": "Column",
      "blocks": {
        "title": { "type": "heading", "settings": { "text": "Feature", "tag": "h3", "display_size": "h3" } },
        "desc": { "type": "text", "settings": { "content": "Details about this feature." } }
      },
      "block_order": ["title", "desc"]
    }
  ]
}
{% endschema %}
